@vcr
Feature: CLI

  Scenario: Get version
    When I run `multichain -v`
    Then the output should contain "multichain version"

  @vcr
  Scenario: Encode a string
    When I successfully run `multichain hexify http://metrics.theodi.org/metrics/2013-q3-completed-tasks`
    Then the output should contain "c687474703a2f2f6d6574726963732e7468656f64692e6f72672f6d6574726963732f323031332d71332d636f6d706c657465642d7461736b737c7b22416363657074223a226170706c69636174696f6e2f6a736f6e227d7c31313533353363326366643034633935303938646166643130613934643163623038356530626466633362343830623134383564346461326365646232663030"

  Scenario: Decode a string
    When I successfully run `multichain dehexify 313435323030323030307c687474703a2f2f6d6574726963732e7468656f64692e6f72672f6d6574726963732f323031352d71342d636f6d706c657465642d7461736b732e6a736f6e7c7b22416363657074223a226170706c69636174696f6e2f6a736f6e227d7c32663266313635373862646432623863353835653931316362393232363430666438653531303162336331326163323661383537383633633032663661616563`
    Then the output should contain "1452002000|http://metrics.theodi.org/metrics/2015-q4-completed-tasks.json|"
    And the output should contain "application/json"
    And the output should contain "|2f2f16578bdd2b8c585e911cb922640fd8e5101b3c12ac26a857863c02f6aaec"

  Scenario: Verify an entry
    When I successfully run `multichain verify 313435323030323131357c687474703a2f2f6d6574726963732e7468656f64692e6f72672f6d6574726963732f6769746875622d746f74616c2d70756c6c2d72657175657374737c7b22416363657074223a226170706c69636174696f6e2f6a736f6e227d7c35616536653931373830626134623962306361653562346239313135623835636633313933613838626439666331316430353231366531316330373762383966`
    Then the output should contain "'http://metrics.theodi.org/metrics/github-total-pull-requests' is verified"
    And the exit status should be 0

  Scenario: Do not verify a duff entry
    When I run `multichain verify 313435323030323131357c687474703a2f2f6d6574726963732e7468656f64692e6f72672f6d6574726963732f6769746875622d746f74616c2d70756c6c2d72657175657374737c7b22416363657074223a226170706c69636174696f6e2f6a736f6e227d7c3561653665393137383062613462396230636165356234623931313562383563663331393361383862643966633131643035323136653131633037376238396`
    Then the output should contain "'http://metrics.theodi.org/metrics/github-total-pull-requests' is not verified"
    And the exit status should be 1
